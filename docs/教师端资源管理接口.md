### AI智慧课程系统 - 教师资源管理接口文档

---

#### **文档说明**
- **基础URL**：`暂无`
- **认证方式**：Bearer Token (JWT)
- **权限要求**：教师角色
- **数据格式**：JSON（除上传接口使用multipart/form-data）
- **时间格式**：ISO 8601 (`yyyy-MM-dd'T'HH:mm:ss`)
- **文件限制**：最大100MB，支持类型：PPT/PDF/视频/文档/链接

---

### 1. 上传课程资源
**上传文件资源到指定课程**

#### 请求信息
| 项目             | 内容                                        |
| ---------------- | ------------------------------------------- |
| **HTTP方法**     | POST                                        |
| **端点**         | `/api/teacher/courses/{courseId}/resources` |
| **认证**         | Bearer Token                                |
| **Content-Type** | `multipart/form-data`                       |

#### 路径参数
| 参数     | 类型   | 必需 | 说明   |
| -------- | ------ | ---- | ------ |
| courseId | String | 是   | 课程ID |

#### 表单参数
| 字段        | 类型   | 必需 | 说明     | 约束                      |
| ----------- | ------ | ---- | -------- | ------------------------- |
| file        | File   | 是   | 资源文件 | 最大100MB，支持类型见说明 |
| name        | String | 是   | 资源名称 | 长度2-100字符             |
| type        | String | 是   | 资源类型 | PPT/PDF/VIDEO/DOCUMENT    |
| description | String | 否   | 资源描述 | 最大500字符               |

#### 响应
**成功响应 (201 Created)**
```json
{
  "code": 201,
  "message": "资源上传成功",
  "data": {
    "resourceId": "res001",
    "name": "数据结构讲义",
    "type": "PDF",
    "url": "/resources/course_c001/res001.pdf",
    "size": 204800,
    "description": "第一章课程讲义",
    "uploader": "张教授",
    "uploadTime": "2025-06-17T10:30:45",
    "viewCount": 0
  }
}
```

**错误响应**
- 400 Bad Request: 文件类型不支持或参数验证失败
- 403 Forbidden: 无权操作此课程
- 404 Not Found: 课程不存在
- 413 Payload Too Large: 文件超过100MB限制
- 415 Unsupported Media Type: 文件类型不支持
- 500 Internal Server Error: 文件保存失败

---

### 2. 获取课程资源列表
**获取指定课程的所有资源**

#### 请求信息
| 项目         | 内容                                        |
| ------------ | ------------------------------------------- |
| **HTTP方法** | GET                                         |
| **端点**     | `/api/teacher/courses/{courseId}/resources` |
| **认证**     | Bearer Token                                |

#### 路径参数
| 参数     | 类型   | 必需 | 说明   |
| -------- | ------ | ---- | ------ |
| courseId | String | 是   | 课程ID |

#### 查询参数
| 参数 | 类型   | 必需 | 说明     | 约束                   |
| ---- | ------ | ---- | -------- | ---------------------- |
| type | String | 否   | 资源类型 | PPT/PDF/VIDEO/DOCUMENT |
| page | Int    | 否   | 当前页码 | 默认1                  |
| size | Int    | 否   | 每页数量 | 默认10, 最大50         |

#### 响应
**成功响应 (200 OK)**
```json
{
  "code": 200,
  "message": "成功获取资源列表",
  "data": {
    "page": 1,
    "size": 10,
    "totalElements": 25,
    "totalPages": 3,
    "content": [
      {
        "resourceId": "res001",
        "name": "课程PPT",
        "type": "PPT",
        "url": "/resources/course_c001/lecture1.ppt",
        "size": 102400,
        "description": "第一章课件",
        "uploader": "张教授",
        "uploadTime": "2025-06-10T14:30:00",
        "viewCount": 45
      },
      {
        "resourceId": "res002",
        "name": "参考视频",
        "type": "VIDEO",
        "url": "/resources/course_c001/demo.mp4",
        "size": 512000,
        "description": "实验演示视频",
        "uploader": "李教授",
        "uploadTime": "2025-06-15T09:15:00",
        "viewCount": 120
      }
    ]
  }
}
```

**错误响应**
- 403 Forbidden: 无权访问此课程
- 404 Not Found: 课程不存在

---

### 3. 获取资源详情
**获取指定资源的详细信息**

#### 请求信息
| 项目         | 内容                                  |
| ------------ | ------------------------------------- |
| **HTTP方法** | GET                                   |
| **端点**     | `/api/teacher/resources/{resourceId}` |
| **认证**     | Bearer Token                          |

#### 路径参数
| 参数       | 类型   | 必需 | 说明   |
| ---------- | ------ | ---- | ------ |
| resourceId | String | 是   | 资源ID |

#### 响应
**成功响应 (200 OK)**
```json
{
  "code": 200,
  "message": "成功获取资源详情",
  "data": {
    "resourceId": "res001",
    "name": "数据库设计文档",
    "type": "DOCUMENT",
    "url": "/resources/course_c001/db-design.docx",
    "size": 30720,
    "description": "数据库设计规范文档",
    "uploader": "王教授",
    "uploadTime": "2025-06-12T11:20:00",
    "viewCount": 78,
    "courseId": "c001",
    "courseName": "数据库系统"
  }
}
```

**错误响应**
- 403 Forbidden: 无权访问此资源
- 404 Not Found: 资源不存在

---

### 4. 更新资源信息
**更新资源的元数据信息**

#### 请求信息
| 项目             | 内容                                  |
| ---------------- | ------------------------------------- |
| **HTTP方法**     | PUT                                   |
| **端点**         | `/api/teacher/resources/{resourceId}` |
| **认证**         | Bearer Token                          |
| **Content-Type** | `application/json`                    |

#### 路径参数
| 参数       | 类型   | 必需 | 说明   |
| ---------- | ------ | ---- | ------ |
| resourceId | String | 是   | 资源ID |

#### 请求体
```json
{
  "name": "更新后的资源名称",
  "description": "更新后的资源描述信息",
  "type": "PDF"
}
```

#### 响应
**成功响应 (200 OK)**
```json
{
  "code": 200,
  "message": "资源更新成功",
  "data": {
    "resourceId": "res001",
    "name": "更新后的资源名称",
    "type": "PDF",
    "url": "/resources/course_c001/res001.pdf",
    "size": 204800,
    "description": "更新后的资源描述信息",
    "uploader": "张教授",
    "uploadTime": "2025-06-17T10:30:45",
    "viewCount": 5
  }
}
```

**错误响应**
- 400 Bad Request: 参数验证失败
- 403 Forbidden: 无权修改此资源
- 404 Not Found: 资源不存在

---

### 5. 删除资源
**删除指定资源**

#### 请求信息
| 项目         | 内容                                  |
| ------------ | ------------------------------------- |
| **HTTP方法** | DELETE                                |
| **端点**     | `/api/teacher/resources/{resourceId}` |
| **认证**     | Bearer Token                          |

#### 路径参数
| 参数       | 类型   | 必需 | 说明   |
| ---------- | ------ | ---- | ------ |
| resourceId | String | 是   | 资源ID |

#### 响应
**成功响应 (204 No Content)**  
无响应体

**错误响应**
- 403 Forbidden: 无权删除此资源
- 404 Not Found: 资源不存在
- 409 Conflict: 资源被任务引用无法删除
```json
{
  "code": 409,
  "message": "资源被任务引用，无法删除",
  "details": {
    "taskCount": 2
  }
}
```

---

### 6. 下载资源
**下载资源文件内容**

#### 请求信息
| 项目         | 内容                                           |
| ------------ | ---------------------------------------------- |
| **HTTP方法** | GET                                            |
| **端点**     | `/api/teacher/resources/{resourceId}/download` |
| **认证**     | Bearer Token                                   |

#### 路径参数
| 参数       | 类型   | 必需 | 说明   |
| ---------- | ------ | ---- | ------ |
| resourceId | String | 是   | 资源ID |

#### 响应
**成功响应 (200 OK)**  
文件二进制流，Content-Type根据文件类型确定

**Headers**:
- Content-Disposition: attachment; filename="filename.ext"

**错误响应**
- 403 Forbidden: 无权下载此资源
- 404 Not Found: 资源不存在
- 410 Gone: 资源文件已被删除

---

### 错误码汇总
| 状态码 | 错误码 | 说明                   |
| ------ | ------ | ---------------------- |
| 200    | 200    | 操作成功               |
| 201    | 201    | 资源创建成功           |
| 204    | 204    | 操作成功，无返回内容   |
| 400    | 400    | 请求参数错误           |
| 403    | 403    | 无操作权限             |
| 404    | 404    | 资源不存在             |
| 409    | 409    | 资源冲突或业务规则冲突 |
| 413    | 413    | 文件大小超过限制       |
| 415    | 415    | 不支持的文件类型       |
| 500    | 500    | 服务器内部错误         |

---

### 请求示例 (cURL)

**上传资源**:
```bash
curl -X POST "https://api.aicourse.com/v1/api/teacher/courses/c001/resources" \
-H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..." \
-F "file=@/path/to/lecture.pdf" \
-F "name=数据结构讲义" \
-F "type=PDF" \
-F "description=第一章课程讲义"
```

**获取资源列表**:
```bash
curl -X GET "https://api.aicourse.com/v1/api/teacher/courses/c001/resources?type=PDF&page=1&size=5" \
-H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
```

**更新资源**:
```bash
curl -X PUT "https://api.aicourse.com/v1/api/teacher/resources/res001" \
-H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..." \
-H "Content-Type: application/json" \
-d '{
  "name": "更新后的讲义名称",
  "description": "更新后的描述信息"
}'
```

**删除资源**:
```bash
curl -X DELETE "https://api.aicourse.com/v1/api/teacher/resources/res001" \
-H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
```

**下载资源**:
```bash
curl -X GET "https://api.aicourse.com/v1/api/teacher/resources/res001/download" \
-H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..." \
-o lecture.pdf
```

---

### 设计说明
1. **文件存储规范**：
   - 存储路径：`/resources/course_{courseId}/[type]/[uuid]_[filename]`
   - 文件名使用UUID防止冲突：`f3a58c2b-lecture1.pdf`
   - 按课程ID和资源类型分目录存储

2. **安全机制**：
   - 文件类型白名单验证（PPT/PDF/视频/文档）
   - 文件内容病毒扫描（集成ClamAV）
   - 上传目录与web根目录分离
   - 敏感资源访问日志记录

3. **资源关联**：
   - 资源删除前检查是否被任务引用
   - 资源更新保留历史版本（可选）
   - 资源下载记录访问日志

4. **性能优化**：
   - 大文件分块上传支持
   - 视频资源转码处理
   - 资源文件CDN分发
   - 高频访问资源缓存

5. **扩展功能**：
   - 资源版本管理
   - 资源访问权限分级
   - 资源使用统计报告
   - 自动OCR文本提取（用于搜索）